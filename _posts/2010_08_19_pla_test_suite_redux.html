---
layout: bloggerpost
title: PLA Test Suite Redux
---

I've been doing a hell of a lot of work on the Parrot-Linear-Algebra test suite in the past few days, and the results are quite spectacular. I've completely reworked the way the suite works, and broke a small handful of monolithic test files into a series of smaller, focused test files. Instead of describing it, I'll just show the results:<br /><br /><pre>t/sanity.t .............................................. ok<br />t/pmc/pmcmatrix2d.t ..................................... ok<br />t/pmc/nummatrix2d.t ..................................... ok<br />t/pmc/complexmatrix2d.t ................................. ok<br />t/methods/nummatrix2d/convert_to_complex_matrix.t ....... ok<br />t/methods/nummatrix2d/row_scale.t ....................... ok<br />t/methods/nummatrix2d/get_block.t ....................... ok<br />t/methods/nummatrix2d/mem_transpose.t ................... ok<br />t/methods/nummatrix2d/convert_to_number_matrix.t ........ ok<br />t/methods/nummatrix2d/initialize_from_args.t ............ ok<br />t/methods/nummatrix2d/row_swap.t ........................ ok<br />t/methods/nummatrix2d/iterate_function_inplace.t ........ ok<br />t/methods/nummatrix2d/fill.t ............................ ok<br />t/methods/nummatrix2d/initialize_from_array.t ........... ok<br />t/methods/nummatrix2d/iterate_function_external.t ....... ok<br />t/methods/nummatrix2d/transpose.t ....................... ok<br />t/methods/nummatrix2d/item_at.t ......................... ok<br />t/methods/nummatrix2d/gemm.t ............................ ok<br />t/methods/nummatrix2d/row_combine.t ..................... ok<br />t/methods/nummatrix2d/resize.t .......................... ok<br />t/methods/nummatrix2d/convert_to_pmc_matrix.t ........... ok<br />t/methods/nummatrix2d/set_block.t ....................... ok<br />t/methods/complexmatrix2d/convert_to_complex_matrix.t ... ok<br />t/methods/complexmatrix2d/row_scale.t ................... ok<br />t/methods/complexmatrix2d/get_block.t ................... ok<br />t/methods/complexmatrix2d/mem_transpose.t ............... ok<br />t/methods/complexmatrix2d/convert_to_number_matrix.t .... ok<br />t/methods/complexmatrix2d/initialize_from_args.t ........ ok<br />t/methods/complexmatrix2d/row_swap.t .................... ok<br />t/methods/complexmatrix2d/iterate_function_inplace.t .... ok<br />t/methods/complexmatrix2d/fill.t ........................ ok<br />t/methods/complexmatrix2d/initialize_from_array.t ....... ok<br />t/methods/complexmatrix2d/conjugate.t ................... ok<br />t/methods/complexmatrix2d/iterate_function_external.t ... ok<br />t/methods/complexmatrix2d/transpose.t ................... ok<br />t/methods/complexmatrix2d/item_at.t ..................... ok<br />t/methods/complexmatrix2d/gemm.t ........................ ok<br />t/methods/complexmatrix2d/row_combine.t ................. ok<br />t/methods/complexmatrix2d/resize.t ...................... ok<br />t/methods/complexmatrix2d/convert_to_pmc_matrix.t ....... ok<br />t/methods/complexmatrix2d/set_block.t ................... ok<br />t/methods/pmcmatrix2d/convert_to_complex_matrix.t ....... ok<br />t/methods/pmcmatrix2d/get_block.t ....................... ok<br />t/methods/pmcmatrix2d/mem_transpose.t ................... ok<br />t/methods/pmcmatrix2d/convert_to_number_matrix.t ........ ok<br />t/methods/pmcmatrix2d/initialize_from_args.t ............ ok<br />t/methods/pmcmatrix2d/iterate_function_inplace.t ........ ok<br />t/methods/pmcmatrix2d/fill.t ............................ ok<br />t/methods/pmcmatrix2d/initialize_from_array.t ........... ok<br />t/methods/pmcmatrix2d/iterate_function_external.t ....... ok<br />t/methods/pmcmatrix2d/transpose.t ....................... ok<br />t/methods/pmcmatrix2d/item_at.t ......................... ok<br />t/methods/pmcmatrix2d/resize.t .......................... ok<br />t/methods/pmcmatrix2d/convert_to_pmc_matrix.t ........... ok<br />t/methods/pmcmatrix2d/set_block.t ....................... ok<br />PASSED 356 tests in 55 files<br /></pre><br />I factored out all tests to delegate matrix creation and matrix population routines into a series of type-specific factory objects. With these factories, creation of tests goes extremely quickly:<br /><br /><ol><li>Write tests using a few methods and values from the factory instead</li><li>Create a short stub test for each Matrix type, subclassing the common tests and add a proper factory</li><li>There is no step 3.</li></ol>It's really become quite simple, andÂ  I'm much happier with the test suite now. Plus, I've added plenty of new features lately (complete with tests!) and I'm going to talk about that plenty in a later post.