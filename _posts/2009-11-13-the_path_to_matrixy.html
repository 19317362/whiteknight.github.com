---
layout: bloggerpost
title: The Path to Matrixy
---

I've spent a little bit of time in the last week working on the <a href="http://github.com/Whiteknight/matrixy/tree/pla_integration">pla_integration branch</a> for <a href="http://github.com/Whiteknight/matrixy">Matrixy</a>. The goal of that branch is to update Matrixy to use <a href="http://github.com/Whiteknight/parrot-linear-algebra">Parrot-Linear-Algebra</a> as an external dependency, and to use its matrix types natively instead of the <span style="font-style: italic;">ad hoc</span> home-brewed aggregate types I had been using previously. In short, I'm doing things the way they should have been done in the first place.<br /><br />As of Sunday evening, the branch could <a href="http://github.com/Whiteknight/matrixy/commit/2df6d8d71adc7657f11b3d612b06656df5dce8b6">build</a>, <a href="http://github.com/Whiteknight/matrixy/commit/9cd152d785034df5eaddc1656c57b917a96f4715">run</a>, and execute the test suite. There are several tests that are failing still (many of which are to be expected), but a good number that are successfully passing too, which is good.<br /><br />String handling is one area where I was expecting some serious regressions, and was not surprised in that regard. M uses a very idiosyncratic handling <a href="http://wknight8111.blogspot.com/2009/11/string-handling-in-m.html">as I've mentioned before</a>, and all tests that are relying on complicated string behavior are failing miserably. In response to this, last night <a href="http://github.com/Whiteknight/parrot-linear-algebra/commit/6b96bac991554542ec70cf85f1cb0dd9175c7c33">I created a new matrix type</a> in the Parrot-Linear-Algebra project: a 2D character matrix type that will be used to implement Matrixy's string handling. My task now is to improve this new matrix type (including adding a test suite for it) and integrating it into Matrixy. I started some of that last night but haven't pushed any of my work to the public repo yet.<br /><br />Another thing I added last night was the "matrix" role. Any of the matrix types in Parrot-Linear-Algebra will now respond positively to a "does 'matrix'" query. An object that fulfills the matrix role will have the following properties:<br /><ol><li>Contains a number of elements arranged in a rectangular NxM grid</li><li>Elements can be accessed linearly using a single integer index (behavior varies by type, but it is always possible)</li><li>Elements can be accessed by X,Y 2-ary coordinates to retrieve a value</li><li>Matrices can grow automatically to accommodate newly inserted values</li><li>Matrices should stringify in such a way where each row of the matrix will be on it's own line (rows separated by newlines). The formatting of each individual row is dependent on the type of the matrix.</li></ol>With a nice standard interface like this, these matrix types should be consistently usable from HLLs, and I know Matrixy is going to be making aggressive use of these features to implement even it's most basic behaviors. I may try to add new requirements to this list, specifically there are some methods that I would like every matrix type to have (is_scalar(), is_empty(), etc.), and maybe a few other behaviors that should become standard between all our types. I'm starting to think that a templating system will become a necessity to prevent us from needing to rewrite similar algorithms for what could become dozens of matrix and vector types. The improved grammar support in NQP-RX may be the catalyst that makes these changes possible. It's another task for another day.<br /><br />Speaking of tasks, on the near-term TODO list I plan to add specialized vector types to Parrot-Linear-Algebra, add tests for the new matrix and vector types, beef up the CharMatrix2D type to handle the string operations that Matrixy needs, and continue fixing the pla_integration branch for Matrixy to pass more of it's tests. On top of all that, there's a <a href="http://wknight8111.blogspot.com/2009/11/november-testing-hackathon.html">testing hackathon</a> this weekend that I want to participate in, some <a href="http://wknight8111.blogspot.com/2009/11/mediawiki-book-designer.html">work for Wittie</a> that I need to finish, and <a href="http://whitworthpa.blogspot.com/2009/11/37-weeks.html">possibly having a baby</a>. Could turn out to be the very busy next few days for me!