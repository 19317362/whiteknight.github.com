---
layout: bloggerpost
title: So Bad It's Funny
---

At work I've been taking a program written by another engineer and trying to merge the functionality into a program that I've been writing. During this process, I have found some code so bad that it's both funny and depressing at the same time. Here is a great example:<br />[Update 10 Feb 2010: This code is C#]<br /><pre><br />public bool CheckMsgValid(byte[] _myArray, int _myIdx) &#123;<br />   bool t;<br />   t = ((_myArray[_myIdx] & 0x80) == 0x80) ? true : false;<br />   return t;<br />&#125;<br /></pre><br />...which is basically the long way to write:<br /><pre><br />public bool CheckMsgValid(byte[] b, int x) &#123;<br />   return b[x] & 0x80 != 0 ;<br />&#125;<br /></pre><br />I guess the original coder wanted to make double-sure that the two values were equal.
                <div class='old-blogger-comments'>
                    <h2 class='old-comment-header'>Comments</h3>
                <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    erm, not this?<br />return b[x] & 0x80;
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://muixirt.wordpress.com/'>muixirt</a>

                    <span class='blogger-comment-datestamp'>
                        2/10/2010 3:58:38 PM
                    </span>
                </div>
            </div>
            <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    I should have mentioned, the code above was C#, not C. Because of the increased type safety, just "b[x] & 0x80" wouldn't return a bool.
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://www.blogger.com/profile/16207472474429254890'>Whiteknight</a>

                    <span class='blogger-comment-datestamp'>
                        2/10/2010 4:30:28 PM
                    </span>
                </div>
            </div>
            <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    So what does _myArray[_myIdx] & 0x80 mean in C# and why is it superfluous in your code? I thought it was some bit masking.
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://muixirt.wordpress.com/'>muixirt</a>

                    <span class='blogger-comment-datestamp'>
                        2/10/2010 4:47:05 PM
                    </span>
                </div>
            </div>
            <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    It is bitmasking. Then the "==" compares the mask and produces a bool.
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://www.blogger.com/profile/16207472474429254890'>Whiteknight</a>

                    <span class='blogger-comment-datestamp'>
                        2/10/2010 5:11:38 PM
                    </span>
                </div>
            </div>
            <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    I'm puzzled. Suppose in b[x] the value 129 (0x81) is stored. What are the results of both functions?
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://muixirt.wordpress.com/'>muixirt</a>

                    <span class='blogger-comment-datestamp'>
                        2/10/2010 5:37:20 PM
                    </span>
                </div>
            </div>
            <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    Ah, you're right. I had a typo above. Fixed.
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://www.blogger.com/profile/16207472474429254890'>Whiteknight</a>

                    <span class='blogger-comment-datestamp'>
                        2/10/2010 6:50:40 PM
                    </span>
                </div>
            </div>
            <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    In the meantime I installed a C# compiler on my linux box.  And it wasn't happy with that either. Maybe: return (b[x] & 0x80) != 0 ;
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://muixirt.wordpress.com/'>muixirt</a>

                    <span class='blogger-comment-datestamp'>
                        2/10/2010 7:18:34 PM
                    </span>
                </div>
            </div>
            </div>
