---
layout: bloggerpost
title: Parrot Test Matrix
---

In anticipation of Parrot's 2.0 release this thursday I've been going crazy trying to run tests on as many platforms as possible. Since I've started using <a href="http://wknight8111.blogspot.com/2009/12/computer-status-and-virtualization.html">VirtualBox</a> I've been able to dramatically increase the number of platforms where I can do testing. Here is a matrix of all the various platforms where I've done tests, and what the results of each are.<br /><br /><span style="font-size:180%;">x64 Ubuntu 9.04</span><br />Ubuntu 9.04 is my primary operating system that I use on my personal laptop. Due to problems with the upgrade I will not be switching it to 9.10 any time soon. I used to have a second partition with <a href="http://wknight8111.blogspot.com/2009/07/parrot-on-win64.html">64-bit Windows Vista</a>, but after my last reinstall I wiped that partition out. Any Linux variant is going to have decent support for Parrot. Many of Parrot's developers and current end-users use Linux, so we are typically able to keep it running smoothly there.<br /><br /><span style="font-weight: bold;">GCC 4.3.3:</span> Nothing to see here, GCC builds always just work. This is probably because a majority of Parrot developers and testers are working on some combination of Linux/GCC. Test failures on GCC, when they appear at all, tend to be short-lived and quickly fixed. My most recent test runs have shown no errors here. <span style="font-weight: bold;">Result: No Failures</span><br /><pre><br />perl Configure.pl --cc=gcc --link=gcc --ld=gcc<br /></pre><br /><br /><span style="font-weight: bold;">G++ 4.3.3: </span>The G++ builds almost always perform as well as vanilla GCC builds do. The primary difference to worry about are the few new keywords that C++ defines but C89 does not. Variables called "new" are a great example of something that breaks the G++ build. Assuming the software builds with G++, it typically passes tests just as well as the normal GCC build does. My most recent test runs have shown no test failures here. <span style="font-weight: bold;">Result: No Failures</span><br /><pre><br />perl Configure.pl --cc=g++ --cxx=g++ --link=g++ --ld=g++<br /></pre><br /><br /><span style="font-weight: bold;">Intel C++ 11.1:</span> Intel offers it's C++ compiler, ICC, <a href="http://software.intel.com/en-us/articles/non-commercial-software-development/">free for non-commercial use</a> on Linux. It's a bit of a pain to install and it isn't open-source, but it's a good compiler nonetheless.  By default ICC outputs many helpful warning messages about troublesome code that GCC ignores. Also, ICC has some extremely powerful and aggressive optimizations that can make Parrot noticeably faster than a GCC build in some benchmarks. Some test failures do show up in the ICC build, but all of them that I have seen involve incorrect handling of "negative zero". I've posted a <a href="http://lists.parrot.org/pipermail/parrot-dev/2010-January/003651.html">question to the list</a> about these errors and didn't see any definitive replies that would have helped me fix these tests. So long as the software you are writing does not depend on proper handling of signed zero, this shouldn't be an issue. <span style="font-weight: bold;">Result: 5 Test Failures</span><br /><pre><br />perl Configure.pl --cc=icc --link=icc --ld=icc<br /></pre><br /><br /><span style="font-weight: bold;">Clang 1.1:</span> Clang isn't packaged on Ubuntu, so it isn't as easy to install as GCC or G++. ICC comes as a binary with an automated installer. Clang, on the other hand <a href="http://clang.llvm.org/get_started.html">needs to be built from source</a>. Luckily this build, though lengthy, tends to occur without any problems or magic incantations. Parrot built with Clang performs very well and typically doesn't experience any additional failures from the GCC build. Also, like ICC, Clang outputs a number of warning and diagnostics messages by default that can be very helpful. <span style="font-weight: bold;">Result: No Failures</span><br /><pre><br />perl Configure.pl --cc=clang --link=clang --ld=clang<br /></pre><br /><br /><span style="font-size:180%;">x86 Ubuntu 9.10</span><br />I run Ubuntu 9.10 in a virtual machine because there were so many problems running it natively on my personal laptop. However, since my processor doesn't support hardware-level virtualization I cannot virtualize a 64-bit version of it. Ubuntu 9.10 uses more recent versions of GCC and other build utilities by default, although it's not the cutting edge.<br /><br /><span style="font-weight: bold;">GCC 4.4.1:</span> Again, this is basically Parrot's native environment. As with the GCC build on x64, there are plenty of developers using this platform, plenty of end-users using it, and very few bugs show up here. <span style="font-weight: bold;">Result: No Failures</span><br /><br /><span style="font-weight: bold;">G++ 4.4.1:</span> Again, G++ performs very similarly to GCC and so long as the build isn't broken because of misuse of C++ keywords, there tend to be no extra test failures. <span style="font-weight: bold;">Result: No Failures</span><br />x86 OpenSolaris 2009.06<br /><br /><span style="font-weight: bold;">Intel C++ 11.1:</span> Similar to my notes above: Install is a pain and is not open source. However, the build is good and optimizations are top notch. ICC on x86 has the same negative zero failures that the build on x86-64 has. For most applications, these failures won't pose any problems for end users.<span style="font-weight: bold;">Result: 5 Test Failures</span><br /><br /><span style="font-weight: bold;">Clang 1.1:</span> Clang always performs similarly to GCC in my experience, and testing produces no challenges to that rule. No problems here. <span style="font-weight: bold;">Result: No Failures</span><br /><br /><span style="font-size:180%;">x86 OpenSolaris 2009.06:</span><br />Using VirtualBox has allowed me to test out some new operating systems that I would never have gambled on otherwise. OpenSolaris is an interesting platform that is very Linux-like in most regards. It has Gnome and Bash, so any Linux user will feel mostly at home with OpenSolaris. There are a few places where the OS feels a little bit more fragile to me. For example, one installation of it started having Xorg problems after I made a change in one of the network adaptors, and I haven't been able to use it since. Intel does not appear to provide a free version of ICC for OpenSolaris, though I haven't tried yet to use the Linux installer. I tried and failed several times to build Clang on OpenSolaris.<br /><br /><span style="font-weight: bold;">GCC 3.4.5:</span> Part of me is amazed that OpenSolaris uses such an old version of GCC by default. If you're trying to keep your platform stable and rock-solid it can be easy to fall into the trap of never upgrading (or upgrading very slowly) the components that "just work". Also, I absolutely refuse to build GCC myself, especially on systems that already have it available (or have a package downloadable). Even though GCC 3.4.5 is a stable and dependable release, it still doesn't produce a properly-performing Parrot binary. There are several test failures, espcially involving mathematics functions asin, acos, atan, ln, log10, and log2. I haven't been able to dig too deep into any of these, but it is appearing like some of the libc functions of the same names are just returning incorrect values. Also, there are some very troubling failures in t/compilers/complete_workflow.t that I haven't looked at in depth yet.<span style="font-weight: bold;"> Result: 15 Test Failures</span><br /><br /><span style="font-weight: bold;">G++ 3.4.5:</span> Same as GCC. <span style="font-weight: bold;">Result: 15 Test Failures</span><br /><br /><span style="font-size:180%;">x86 Windows XP</span><br />On a windows platform there are basically two routes to build Parrot: The first is to use <a href="http://www.activestate.com/">ActivePerl</a> and <a href="http://msdn.microsoft.com/en-us/windows/bb980924.aspx">MSVC</a>, the second is to use <a href="http://strawberryperl.com/">Strawberry Perl</a> and the included MinGW compiler. Mixing and matching causes problems. This is partly because Parrot still derives too many of it's configuration settings from the Perl binary installation, and on Windows there are too many differences to worry about. Since we can't mix and match, to test multiple compilers we need to have multiple Perl installations, which can get really ugly if we want to have at least one Perl install in your PATH. On my current Windows system I have not taken the effort to install both toolchains in parallel and properly sandbox them. So, for the time being, I am only using ActivePerl/MSVC. The build with Strawberry Perl and MinGW tends to perform very similarly to the GCC build on Linux, so it isn't as interesting to me. Intel does not provide a free compiler for Windows platforms, even for non-commercial uses. At least, I haven't found such a download. I have not tried to build Clang on Windows.<br /><br /><span style="font-weight: bold;">Microsoft Visual C++ 15.00:</span> The build here is always a little sketchy, there are some tests that are marked TODO but always seem to pass anyway. There are a few other tests that fail intermittently. When tests on this platform fail they tend to remain failing because we have so few developers working on Windows. Sometimes we may not find out about and work to fix errors on Windows until moments before a release. Also the build is a little slower, Microsoft's nmake utility doesn't appear to support (or doesn't support well) parallel builds. Despite the flakeyness of this system, at the moment there are no failures here. <span style="font-weight: bold;">Result: No Failures</span><br /><br /><span style="font-size:180%;">x86 Ubuntu 8.04</span><br />This is a slightly older platform, and I would have ignored it entirely if I hadn't heard rumor of problems here. What's so interesting about Ubuntu 8.04 is that it's a long-term support release so it's very possible that Parrot end users could be using this system for some time to come. The GCC and G++ builds on this system, despite the rumors I had heard, go off without a hitch. It's interesting that, even though this OS is more than a year old, it uses a more recent version of GCC than OpenSolaris does. I haven't bothered to try installing ICC or Clang here, yet.<br /><br /><span style="font-weight: bold;">GCC 4.2.4:</span> Build works without problems and all tests pass. <span style="font-weight: bold;">Result: No Failures<br /><br />G++ 4.2.4:</span> Surprise, Surprise: no difference from the GCC build. <span style="font-weight: bold;">Result: No Failures</span><br /><br />There are a handful of other systems I have been looking into, but don't have any recent test results to share. Fedora 12 uses a more recent version of GCC for instance, but VirtualBox 3.1.2 isn't compatible with the version of Xorg that's on Fedora 12, so I haven't used Fedora since I upgraded VirtualBox. I haven't been able to get any BSD variants working in VirtualBox either, even though the documentation seems to suggest OpenBSD and maybe FreeBSD should work. I no longer have access to a 64-bit Windows environment either. Apparently it's not even legal to run any Apple OS's without Apple hardware, so I haven't attempted to use any of them.
                <div class='old-blogger-comments'>
                    <h2 class='old-comment-header'>Comments</h3>
                <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    There are a couple more environments to test with.<br /><br />MSYS and Cygwin ( MSYS is a thinner version of Cygwin )
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://www.blogger.com/profile/16194386450942224029'>Brad Gilbert</a>

                    <span class='blogger-comment-datestamp'>
                        1/17/2010 10:48:03 AM
                    </span>
                </div>
            </div>
            <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    Yes, good point. I could be testing with Cygwin but I haven't used that platform in a long time. Maybe I can get that setup before Tuesday.
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://www.blogger.com/profile/16207472474429254890'>Whiteknight</a>

                    <span class='blogger-comment-datestamp'>
                        1/17/2010 11:03:21 AM
                    </span>
                </div>
            </div>
            <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    > OpenSolaris is an interesting platform that is very Linux-like in most regards.<br /><br />I love this comment.
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://www.blogger.com/profile/13284330930068467507'>Austin</a>

                    <span class='blogger-comment-datestamp'>
                        2/28/2010 2:02:47 PM
                    </span>
                </div>
            </div>
            </div>
