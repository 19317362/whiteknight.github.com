---
layout: bloggerpost
title: Parrot 2.0&#58; Personal Retrospective
---

A while ago I put out a <a href="http://wknight8111.blogspot.com/2009/05/my-personal-roadmap-for-parrot-20.html">list of tasks that I wanted to see in Parrot 2.0</a>. This wasn't necessarily a list of tasks I wanted to perform personally, more like a wishlist of tasks that I wanted to see in 2.0 and would have been willing and capable of doing myself if necessary. In other words, it was a list of projects I was personally interested in, even if I didn't have the time to complete them all myself.<br /><br />Now that <a href="http://www.parrot.org/news/2010/Parrot-2.0.0">2.0</a> is <a href="http://wknight8111.blogspot.com/2010/01/parrot-20-is-out.html">fresh out of the factory</a> I think it's a good time to go back over this list and review the status of all the things I wanted to have been included.<br /><br /><span style="font-weight: bold;">GC Internals</span>: At the time I wrote the list this task was already done. What I wanted to do was clean up the GC internals and properly encapsulate things so we could add new cores more easily. I had done that work back in May, and since then other work has happened to cleanup and improve the GC internals for clarity and encapsulation. In large part, I consider this task complete. <span style="font-weight: bold;">Final Result: Done</span>.<br /><br /><span style="font-weight: bold;">Incremental GC</span>: This didn't happen, though in the buildup for the 2.0 release a lot of excitement and motivation has been generated to improve the GC. I suspect we will see a Generational GC first, but an incremental GC cannot be far behind (especially if interest in the RTEMS port continues to grow). <span style="font-weight: bold;">Final Result: Not Done.</span><br /><br /><span style="font-weight: bold;">Generational GC</span>: See my comments above. Interest is building and I think the community has at least a tenative agreement that the next GC core we work on will need to be a generational one. Downside to this is the likely need to add write barriers throughout the codebase which can be costly in terms of performance and code bloat. However, we should see performance improvements from it. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">Boehm GC</span>: Bacek put this together recently, but unfortunately the results were not as good as we expected. I did a brief analysis about why performance might have been a problem with the Boehm collector in Parrot, but without doing more benchmarking myself I really don't know what the problem is. Maybe 2010 will see some improvements to this core and better performance as a result. <span style="font-weight: bold;">Final Result: Done</span>.<br /><br /><span style="font-weight: bold;">Context PMCs</span>: This was another project that Bacek put together, and the result was quite spectacular. It only lasted for a while, however, before the Context PMC got merged with the CallSignature PMC into the new CallContext. Some tests broke and performance isn't as good yet as I think it could be, but the hardest part is done now. <span style="font-weight: bold;">Final Result: Done</span>.<br /><br /><span style="font-weight: bold;">RetContinuation Unification</span>: I had anticipated that RetContinuation would be merged into Context first, and then that PMC would have been merged with CallSignature. Things happened in the opposite order with CallSignature and Context being merged into CallContext instead. As of the 2.0 release RetContinuation is still a separate entity, though there are rumblings about changing that and cashing in on the performance win. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">Subclassable Exception Handlers</span>: I'm not really sure where this task ended up, though I assume the work on the Context PMC would have enabled it. At the very least (and I say this without doing any testing or exploring the codebase) the hardest part of the work is now done. I'll mark it off as a success. <span style="font-weight: bold;">Final Result: Done.</span><br /><br /><span style="font-weight: bold;">PCC Refactoring</span>: This was done and ended up being a herculean task. Also, the new (and cleaner!) code brought along a performance penalty that we've been scraping and clawing to mitigate. One thing that cannot be argued though is that the mechanism has been significantly improved and various optimizations and feature additions will be much easier now. <span style="font-weight: bold;">Final Result: Done</span>.<br /><br /><span style="font-weight: bold;">CallSignature Unification</span>: My original intention for this task was that the Context+RetContinuation PMC would be merged into CallSignature. Things happened in the wrong order and CallSignature got merged into Context first. <span style="font-weight: bold;">Final Result: Done</span>.<br /><br /><span style="font-weight: bold;">Subclassable Everything</span>: This task, which would allow all PMC types to be completely subclassable from PIR, was daunting and perhaps a little bit too ambitious. First stage required that most fields in existing PMCs were converted to one of the "big 4" types (INTVAL, FLOATVAL, STRING, PMC). Second stage required that we come up with a sane way of working with opaque pointers and data items from PIR, which we don't have yet. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">:invocant</span>: To my knowledge this one hasn't been added yet. With the new PCC system in place it should be trivial to add, but i haven't seen it done yet. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">Morphable Objects</span>: I can't even really remember what I wanted out of this task, but in hindsight the idea of morphing objects between types doesn't sound like something I would really want to stress. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">Override VTABLE Invoke</span>: I believe this one was added shortly after the PCC refactors landed, though I haven't played with the new implementation myself. I'll mark it as being completed for now. <span style="font-weight: bold;">Final Result: Done</span>.<br /><br /><span style="font-weight: bold;">IO Cleanups</span>: The IO system is decent but does need some work still. I was hoping we would see a proper pipes implementation, and then once we have all the major fundamentals I was hoping we could get some of the various codepaths unified and simplified. This one, unfortunately, did not happen the way I wanted. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">PIR IO Objects</span>: The goal was to properly subclass IO object types from PIR. This would require both the aforementioned "IO Cleanups" with the pipes implementation, and maybe some variation of "Subclassable Everything" so we could manipulate the low-level buffers from PIR. Sadly, this did not get completed. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">Asynch IO</span>: I got derailed on this project, which I put quite a lot of planning effort into, when the IO Cleanups project got stalled. I still have all the best intentions of getting this feature added, but sadly it did not make it into 2.0. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">IO Unification</span>: This was dependent on the Asynch IO task. The goal was that we could merge the code paths between AIO and regular IO, implementing some blocking primitives in terms of their non-blocking counterparts. Without AIO, this was impossible. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">Concurrency Cleanups</span>: The concurrency system is a mess and I was hoping to change that. Plus, AIO needed improvements in this area to allow us to properly integrate things the way they should be. I never took the time to tackle this one and since it was deemed lower priority I don't think anybody else did either. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">Update PDDs</span>: I haven't spent hardly any time on documentation recently, and the docs didn't get improved to the standard that I was envisioning. Other people did work on these but I am not sure if it's the kind of comprehensive overview that I was hoping for. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br /><span style="font-weight: bold;">Parrot Developer Guide</span>: The first published book was a PIR users guide. I was hoping to at least start second book, a more in-depth guide for internals developers. This never got off the ground. <span style="font-weight: bold;">Final Result: Not Done</span>.<br /><br />From among 20 tasks that I was personally interested in seeing included in the 2.0 release, 7 of them were completed. That's actually not a bad number considering the work we did accomplish as a development team, the pathetic level that I have been contributing at for the previous few months, and the enormous scope of some of these tasks.<br /><br />Sometime soon I will try to post a wishlist for the upcoming supported releases: 2.3, 2.6, 2.9, and 3.0.
                <div class='old-blogger-comments'>
                    <h2 class='old-comment-header'>Comments</h3>
                <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    thats alot of work! Parrot is shaping up really nicely :) hows the jit abstraction work comming?
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://redbrain.co.uk'>redbrain</a>

                    <span class='blogger-comment-datestamp'>
                        1/22/2010 11:20:24 AM
                    </span>
                </div>
            </div>
            <div class='blogger-comment-div'>
                <p class='blogger-comment-body'>
                    These are only the handful of projects that I took a strong personal interest in. There were many other projects as well that were completed prior to 2.0 that I don't mention here. Parrot really is developing nicely!<br /><br />I don't know where the JIT work is right now. I've been out of the ratrace for two months now because of other commitments. That is something I need to get back into.
                </p>
                <div class='blogger-comment-author-div'>
                    <span class='blogger-author-sig'><a class='blogger-author-uri' href='http://www.blogger.com/profile/16207472474429254890'>Whiteknight</a>

                    <span class='blogger-comment-datestamp'>
                        1/22/2010 11:49:09 AM
                    </span>
                </div>
            </div>
            </div>
